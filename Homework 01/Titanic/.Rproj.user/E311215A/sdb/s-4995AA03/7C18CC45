{
    "collab_server" : "",
    "contents" : "if (!'dplyr' %in% rownames(installed.packages())) {install.packages('dplyr')}\nlibrary('dplyr')\nif (!'ggplot2' %in% rownames(installed.packages())) {install.packages('ggplot2')}\nlibrary('ggplot2')\nif (!\"scales\" %in% rownames(installed.packages())) {install.packages('scales')}\nlibrary('scales')\n\n# Getting data\ntrain <- read.csv('../train.csv')\ntest <- read.csv('../test.csv')\n\nfull <- bind_rows(train, test)\nstr(full)\n\n# Feature engineering\n## Get passenger title\nfull$Title <- gsub('(.*, )|(\\\\..*)', '', full$Name)\n\ntable(full$Name, full$Title)\nrare_title <- c('Dona', 'Lady', 'the Countess','Capt', 'Col', 'Don', 'Dr', 'Major', 'Rev', 'Sir', 'Jonkheer')\nfull$Title[full$Title == 'Mlle']        <- 'Miss' \nfull$Title[full$Title == 'Ms']          <- 'Miss'\nfull$Title[full$Title == 'Mme']         <- 'Mrs' \nfull$Title[full$Title %in% rare_title]  <- 'Rare Title'\ntable(full$Sex, full$Title)\n\n## Do families sink or swim together?\nfull$FSize <- full$SibSp + full$Parch + 1\nplot_FSize_Survived <- ggplot(full[1:nrow(train), ], aes(x = FSize, fill = factor(Survived)))\nplot_FSize_Survived <- plot_FSize_Survived +\n    geom_bar(stat = 'Count', position = 'dodge') +\n    scale_x_continuous(breaks = c(1:11)) +\n    labs(x = \"Family Size\")\nprint(plot_FSize_Survived)\n\n## Deck\nfull$Deck <- factor(sapply(full$Cabin, function(x) strsplit(x, NULL)[[1]][1]))\n\n# Missingness\n## Embarked\ntable(full$Embarked)\nmissingEmbarked <- full[full$Embarked == \"\", \"PassengerId\"]\n\nembarkFare <- full %>%\n    filter(!Embarked == \"\")\nplot_Embark_Fare <- ggplot(embarkFare, aes(x = Embarked, y = Fare, fill = factor(Pclass)))\nplot_Embark_Fare <- plot_Embark_Fare +\n    geom_boxplot() +\n    geom_hline(aes(yintercept = full[missingEmbarked[1], \"Fare\"]), colour = 'red', linetype = 'dashed', lwd = 2) +\n    scale_y_continuous(labels = dollar_format())\nprint(plot_Embark_Fare)\n\nfull$Embarked[missingEmbarked] <- 'C'\n\n## Fare\nsummary(full$Fare)\nmissingFare <- full[is.na(full$Fare), \"PassengerId\"]\nplot_Fare <- ggplot(full[full$Pclass == full[missingFare[1], \"Pclass\"] &\n                             full$Embarked == full[missingFare[1], \"Embarked\"], ],\n                    aes(x = Fare))\nplot_Fare <- plot_Fare +\n    geom_density(fill = '#99d6ff', alpha = 0.4) +\n    geom_vline(aes(xintercept = median(Fare, na.rm = TRUE)), colour = 'red', linetype = 'dashed', lwd = 1) +\n    scale_x_continuous(labels = dollar_format())\nprint(plot_Fare)\n\nfull$Fare[missingFare] <- median(full[full$Pclass == full[missingFare[1], \"Pclass\"] &\n                                          full$Embarked == full[missingFare[1], \"Embarked\"], \"Fare\"],\n                                 na.rm = TRUE)\n\n# Predictive imputation\n## Age\nsummary(full$Age)\n\n",
    "created" : 1486837194434.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1549797342",
    "id" : "7C18CC45",
    "lastKnownWriteTime" : 1486846609,
    "last_content_update" : 1486846988008,
    "path" : "D:/University/BSc/8th Semester/Foundations of Data Mining/Homework 01/Titanic/Titanic.R",
    "project_path" : "Titanic.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}